<html> 
   <head>                                                                  
      <link rel="stylesheet" type="text/css" media="screen" href="../static/configure-epoch.css" />
      <script type="text/javascript" src="../static/jquery-1.7.1.js"></script>          
      <script type="text/javascript">                                         

      $(document).ready(function() {

         $("select.core.service").change(function(e) {
            service = e.currentTarget.value;

            // Hack https://github.com/alangrafu/lodspeakr/issues/35
            service = service.replace('http://sparql.tw.rpi.edu/services/datafaqs/core/select-faqts/', 'select-faqts:');
            service = service.replace('http://sparql.tw.rpi.edu/services/datafaqs/core/select-datasets/', 'select-datasets');
            service = service.replace('http://sparql.tw.rpi.edu/services/datafaqs/core/augment-datasets/', 'augment-datasets:');

            $(e.currentTarget).after('<p>http://aquarius.tw.rpi.edu/datafaqs/DataFAQs-lodspeakr/special/service-history/'+service+'</p>');

            // http://aquarius.tw.rpi.edu/datafaqs/DataFAQs-lodspeakr/special/service-history/select-faqts:via-sparql-query
            // returns
            // https://raw.github.com/timrdf/DataFAQs/master/services/sadi/core/select-faqts/via-sparql-query-materials/sample-inputs/from-official-sadi-registry.ttl

            // http://aquarius.tw.rpi.edu/datafaqs/DataFAQs-lodspeakr/special/service-history/select-faqts:select-datasets:by-ckan-group
            // returns
            // https://raw.github.com/timrdf/DataFAQs/master/services/sadi/core/select-datasets/by-ckan-group-materials/sample-inputs/thedatahub-datafaqs.ttl
   
            // aquarius.tw.rpi.edu/datafaqs/DataFAQs-lodspeakr/special/service-history/augment-datasets:with-preferred-uri-and-ckan-meta-void
            // returns
            // http://sparql.tw.rpi.edu/datafaqs/epoch/2012-01-21/config/datasets
         })

      });

      </script>                                                               
   </head>                                                              
   <body xmlns:datafaqs="http://purl.org/twc/vocab/datafaqs#"
         xmlns:prov="http://www.w3.org/ns/prov-o/">
      <div>
         <center>
            <a href="https://github.com/timrdf/DataFAQs/wiki">
               <img src="https://github.com/timrdf/DataFAQs/raw/master/doc/DataFAQs.png" alt="DataFAQs logo"/ width="60%"/>
            </a>
         </center>
      </div>

      <div id="epoch" class="configuration">
         <p>
            <span class="step-num">1</span> <span class="step-title">Name the epoch</span>
         </p>
         <span><?php echo date('Y-m-d')?></span>
      </div>

      <div id="select-faqts" class="faqts configuration">
         <p>This gets the <a href="{%for row in r.biordf.FAqTServiceCollection%} {%if forloop.first%} {{row.service.value}} {%endif%} {%endfor%}">first service in r.biordf.FAqTServiceCollection</a>, but the identical code in <a href="https://github.com/timrdf/DataFAQs-lodspeakr/blob/master/models/special.configure-epoch.model.html/biordf/local/inputHistory">the nested query</a> results in an empty expansion <tt>prov:wasAttributedTo <></tt>.
         </p>
         <p>
            <a href="{{first.biordf.FAqTServiceCollection.service.value}}">first.biordf.FAqTServiceCollection.service.value</a>
         </p>
         <p>
            <span class="step-num">2</span> <span class="step-title">Select evaluation services to apply</span>
         </p>
         <p class="step-description">The following SADI services will return lists of FAqT evaluation services. Choose one service and its appropriate input.
         </p>
         <table>
            <tr>
               <th>select-faqts</th>
               <th>Requires input type</th>
            </tr>
            {%for i in r.biordf.FAqTServiceCollection%}
               <tr>
                  <td about="{{i.service.value}}" typeof="datafaqs:FAqTSelector"><a href='{{i.service.value}}'>{{i.service.value}}</a></td>
                  <td about='{{i.input.value}}'><a href='{{i.input.value}}'>{{i.input.value}}</a></td>
               </tr>
            {%endfor%}
         </table>
         <select class="core service">
            {%for i in r.biordf.FAqTServiceCollection%}
               <option value='{{i.service.value}}'>{{i.service.value}}</option>
            {%endfor%}
         </select>
         with input: (new) <input type="text" name="lname" /> or previous:
         <select>
            <option value='previous input 1'>from query</option>
            {%for row in r.biordf.FAqTServiceCollection.local.inputHistory%}
               <option value='{{row.input.value}}'>{{row.input.value}}</option>
            {%endfor%}
         </select>
         <select>
            <option value='previous input 1'>previous input 1</option>
            <option value='previous input 2'>previous input 2</option>
            <option value='previous input 3'>previous input 3</option>
            <option value='previous input 4'>previous input 4</option>
            <option value='previous input 5'>previous input 5</option>
         </select>
      </div>

      <div id="select-datasets" class="datasets configuration">
         <p>
            <span class="step-num">3</span> <span class="step-title">Select datasets to evaluate</span>
         </p>
         <table about="'.$DATASET_URI.'">
            <tr>
               <th>select-faqts</th>
               <th>Requires input type</th>
            </tr>
            {%for i in r.biordf.DatasetCollection%}
               <tr>
                  <td><a href='{{i.service.value}}'>{{i.service.value}}</a></td>
                  <td><a href='{{i.input.value}}'>{{i.input.value}}</a></td>
               </tr>
            {%endfor%}
         </table>
         <select class="core service">
            {%for i in r.biordf.DatasetCollection%}
               <option value='{{i.service.value}}'>{{i.service.value}}</option>
            {%endfor%}
         </select>
         with input: (new) <input type="text" name="lname" /> or previous: 
         <select>
            <option value='previous input 1'>previous input 1</option>
            <option value='previous input 2'>previous input 2</option>
            <option value='previous input 3'>previous input 3</option>
            <option value='previous input 4'>previous input 4</option>
            <option value='previous input 5'>previous input 5</option>
         </select>

         <div id="augment-datasets" class="datasets configuration">
            <p>
               <span class="step-num">3.1</span> 
               <input type="checkbox" name="augment-datasets" />
               <span class="step-title">Augment dataset descriptions</span>
            </p>
            <table>
               <tr>
                  <th>select-faqts</th>
                  <th>Requires input type</th>
               </tr>
               {%for i in r.biordf.WithReferences%}
                  <tr>
                     <td><a href='{{i.service.value}}'>{{i.service.value}}</a></td>
                     <td><a href='{{i.input.value}}'>{{i.input.value}}</a></td>
                  </tr>
               {%endfor%}
            </table>
            <select class="core service">>
               {%for i in r.biordf.WithReferences%}
                  <option value='{{i.service.value}}'>{{i.service.value}}</option>
               {%endfor%}
            </select>
            with input: (new) <input type="text" name="lname" /> or previous: 
            <select>
               <option value='previous input 1'>previous input 1</option>
               <option value='previous input 2'>previous input 2</option>
               <option value='previous input 3'>previous input 3</option>
               <option value='previous input 4'>previous input 4</option>
               <option value='previous input 5'>previous input 5</option>
            </select>
         </div>

      </div> <!-- select-datasets -->

      <center>
         <a href="http://test.ckan.net/"><img src="https://github.com/timrdf/DataFAQs/raw/master/doc/ckan/ckan_logo_box.png" alt="Powered by CKAN" width="80px"/></a>
         <a href="http://sadiframework.org/content/"><img src="https://github.com/timrdf/DataFAQs/raw/master/doc/sadi/sadi-header.png" alt="Powered by SADI" width="150px"/></a>
         <a href="http://code.google.com/p/surfrdf/"><img src="http://surfrdf.googlecode.com/files/surf-logo-poweredby.png" alt="Powered by SuRF" width="150px"/></a>
         <a href="http://lodspeakr.org"><img src="https://github.com/timrdf/DataFAQs/raw/master/doc/lodspeakr/lodspeakr_4.png" alt="Powered by LODSPeaKr" width="100px"/></a>
      </center>
   </body>                                                              
</html>
